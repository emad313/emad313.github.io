const y=r=>{const a=String(r||"");if(!a.startsWith("---"))return{data:{},content:a};const e=a.split(/^(?:---)\s*$/m);if(e.length>=3){const c=e[1].trim(),f=e.slice(2).join("---").trim(),t={};return c.split(/\r?\n/).forEach(i=>{const l=i.match(/^([A-Za-z0-9_\-]+):\s*(.*)$/);if(!l)return;const o=l[1];let s=l[2].trim();if(s.startsWith("[")||s.startsWith("{"))try{t[o]=JSON.parse(s);return}catch{}(s.startsWith('"')&&s.endsWith('"')||s.startsWith("'")&&s.endsWith("'"))&&(s=s.slice(1,-1)),s==="true"&&(s=!0),s==="false"&&(s=!1),t[o]=s}),{data:t,content:f}}return{data:{},content:a}},p=async()=>{try{let r={};try{const e=await fetch("/blogposts/manifest.json");if(!e.ok)throw new Error("Manifest not found");const c=await e.json(),f={};await Promise.all(c.map(async t=>{try{const i=await fetch(`/blogposts/${t}`);if(!i.ok){console.warn(`Failed to fetch /blogposts/${t}: ${i.status}`);return}const l=await i.text();f[`/blogposts/${t}`]=l}catch(i){console.error("Error fetching markdown file",t,i)}})),r=f,console.debug("blogUtils: fetched files from manifest:",Object.keys(r))}catch(e){console.warn("Blog manifest fetch failed:",e),r={}}return Object.entries(r).reduce((e,[c,f])=>{try{let t=f;typeof t=="string"||console.debug("blogUtils: non-string raw type for",c,typeof t),t&&typeof t=="object"&&"default"in t&&(t=t.default),typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer?t=new TextDecoder().decode(t):typeof Uint8Array<"u"&&t instanceof Uint8Array&&(t=new TextDecoder().decode(t)),typeof t!="string"&&(t=String(t));const i=String(t||""),l=i.match(/^---\s*\r?\n([\s\S]*?)\r?\n---\s*\r?\n([\s\S]*)$/);let o={},s=i;if(l){const d=l[1];s=l[2],d.split(/\r?\n/).forEach(m=>{const u=m.match(/^([A-Za-z0-9_\-]+):\s*(.*)$/);if(!u)return;const h=u[1];let n=u[2].trim();if(n.startsWith("[")||n.startsWith("{"))try{o[h]=JSON.parse(n);return}catch{}(n.startsWith('"')&&n.endsWith('"')||n.startsWith("'")&&n.endsWith("'"))&&(n=n.slice(1,-1)),n==="true"&&(n=!0),n==="false"&&(n=!1),o[h]=n})}else{const d=y(i);o=d.data,s=d.content}const g=c.split("/").pop().replace(".md","");e.push({slug:o.slug||g,title:o.title||"Untitled",excerpt:o.excerpt||"",date:o.date||new Date().toISOString(),author:o.author||"Anonymous",category:o.category||"Uncategorized",tags:o.tags||[],image:o.image||"/assets/blog/default.jpg",featured:o.featured||!1,content:s})}catch(t){console.error("Failed to parse markdown file",c,t)}return e},[]).sort((e,c)=>new Date(c.date)-new Date(e.date))}catch(r){return console.error("Error loading blog posts:",r),[]}},b=async r=>{try{return(await p()).find(e=>e.slug===r)||null}catch(a){return console.error("Error loading blog post:",a),null}},S=async()=>{try{const r=await p();return[...new Set(r.map(e=>e.category))].sort()}catch(r){return console.error("Error loading categories:",r),[]}},W=r=>{const a={year:"numeric",month:"long",day:"numeric"};return new Date(r).toLocaleDateString("en-US",a)},A=r=>{const e=r.trim().split(/\s+/).length;return`${Math.ceil(e/200)} min read`};export{S as a,b,A as c,W as f,p as g};
